<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Codyssi 2025 - 17</title>
</head>
<body>
    <script src="input.js"></script>
    <script src="script.js"></script>
    <pre>
Part 1
Difficulty Rating: 4
The submarine’s destruction prevention module kicks in. Soon, the submarine is dashing away. The submarine is programmed to hover around the area, avoiding damage, until you find a way to access it…

“The leviathan is the guardian of Atlantis… Quick! Swim into the castle! It may be forced to stop attacking!”

You make it into the castle as a powerful rumbling shakes the castle. The leviathan must’ve begun its’ attack!

Hmm. Given that the castle hasn’t exploded yet, the leviathan probably doesn’t want to attack the castle it is defending. You’re safe for now, but you’ll have to be quick: your submarine can’t avoid the leviathan’s attacks for long.

After exploring the castle’s halls, you stumble upon a platform that leads to a staircase that spirals and branches. This staircase leads to the exit at the top of the castle. If you can get to that exit, you’ll have the greatest chance at survival! You can’t just swim up, as this region of the castle is actually quite dry.

One of your teammates throws a small rock onto the staircase, and a giant axe-head comes swinging down. It surely would’ve hit anyone standing on that step. This staircase has traps, but there has to be at least one safe path…

One of your teammates spotted a sign close by, and it seemed to contain instructions!

“This sign contains the arrangement of the staircase! It also contains information that can help us determine the safe path…”

For the first task, it seems like you’ll only need the first and last lines in the file!

The first line gives information about the main staircase, which has an ID of “S1”. The line is given in the format “S1 : 0 -> {M} : FROM START TO END”, where M is an integer. The main staircase (S1) has M+1 steps.

Each step on the main staircase (S1) has a step number. The first step on S1 has a step number of 0. The second step on S1 has a step number of 1, and so on. The final step on S1 will have a step number of M.

Your starting position is the first step of the main staircase. The target position is the final step of the main staircase.

A step on staircase N with step number X can be notated by SN_X. This means that your starting position can be notated by S1_0.

A move is defined as a change in position from a starting location to an ending location. The magnitude of a move is defined as the number of steps traversed in that move. For example, S1_0 to S1_1 is a move of magnitude 1, and S1_1 to S1_3 is a move of magnitude 2.

You cannot traverse backwards down the staircase. For example, S1_3 to S1_1 is not a legal move.

A path is defined as a sequence of moves from a starting location to an ending location and is notated by {step 1}-{step 2}-{step 3}-…-{final step}. For example, S1_0-S1_2-S1_3-S1_5 is a path from S1_0 to S1_5 that only uses moves of magnitudes 1 and 2.

The last line in the file contains a list of numbers. This list of numbers determines which move magnitudes are considered as valid.

A valid path is defined as a path that only uses moves of valid magnitudes.

First, you’ll have to find the number of valid paths from your starting position to your target position on the main staircase.

For example, consider the smaller file:

S1 : 0 -> 6 : FROM START TO END
S2 : 2 -> 3 : FROM S1 TO S1

Possible Moves : 1, 3


For this example, your starting position is S1_0 and the target position is S1_6.

There are 6 valid paths from S1_0 to S1_6 on the main staircase. All 6 are shown below.

Path 1: S1_0-S1_1-S1_2-S1_3-S1_4-S1_5-S1_6
Path 2: S1_0-S1_1-S1_2-S1_3-S1_6
Path 3: S1_0-S1_1-S1_2-S1_5-S1_6
Path 4: S1_0-S1_1-S1_4-S1_5-S1_6
Path 5: S1_0-S1_3-S1_4-S1_5-S1_6
Path 6: S1_0-S1_3-S1_6


Hence, the answer for this file is 6.

This is another example file, with a different list of valid move magnitudes:

S1 : 0 -> 6 : FROM START TO END
S2 : 2 -> 4 : FROM S1 TO S1
S3 : 3 -> 5 : FROM S2 TO S1

Possible Moves : 1, 2


For this example, your starting location is still S1_0 and the target position is still S1_6.

However, note that this example has different valid move magnitudes.

In this example, the number of valid paths from S1_0 to S1_6 is 13. Hence, the answer for this example is 13.

Finally, consider this (much) larger example:

S1 : 0 -> 99 : FROM START TO END
S2 : 8 -> 91 : FROM S1 TO S1
S3 : 82 -> 91 : FROM S1 TO S1
S4 : 90 -> 97 : FROM S2 TO S1
S5 : 29 -> 74 : FROM S1 TO S1
S6 : 87 -> 90 : FROM S3 TO S2
S7 : 37 -> 71 : FROM S2 TO S1
S8 : 88 -> 90 : FROM S6 TO S3
S9 : 34 -> 37 : FROM S2 TO S5
S10 : 13 -> 57 : FROM S1 TO S2

Possible Moves : 1, 3, 5, 6


For this file, your starting position is S1_0 and the target position is S1_99.

The number of valid paths from S1_0 to S1_99 on the main staircase in this example is 231843173048269749794.

For this part, you can ignore all other staircase branches, as you are only using the main staircase. Considering your file, what is the number of valid paths from your starting position to your target position?
    </pre>
</body>
</html>